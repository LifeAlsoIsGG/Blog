<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RabbitMQ | Draco&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <link rel="icon" href="/favicon.ico">
    <link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192">
    <link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512">
    <link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png">
    <meta name="description" content="This time I will not be silent">
    <meta property="og:url" content="/MQ/RabbitMQ/RabbitMQ.html">
    <meta property="og:site_name" content="Draco's Blog">
    <meta property="og:title" content="RabbitMQ">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="zh-CN">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="Draco's Blog">
    <meta property="article:author" content="Draco">
    <meta property="article:tag" content="消息队列">
    <meta property="article:published_time" content="2021-08-13T00:04:05.000Z">
    <meta name="theme-color" content="#46bd87">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/assets/css/0.styles.ee34f577.css" as="style"><link rel="preload" href="/assets/js/app.8e6f7e47.js" as="script"><link rel="preload" href="/assets/js/layout-Layout.01663f32.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.29afc31d.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.b32f4377.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout.02c7d76a.js" as="script"><link rel="preload" href="/assets/js/page-RabbitMQ--4585be74.ecf9621f.js" as="script"><link rel="prefetch" href="/assets/js/118.6946fc1c.js"><link rel="prefetch" href="/assets/js/119.bca2602e.js"><link rel="prefetch" href="/assets/js/120.2832e7f3.js"><link rel="prefetch" href="/assets/js/121.50fe6c17.js"><link rel="prefetch" href="/assets/js/122.0bc17515.js"><link rel="prefetch" href="/assets/js/layout-Blog.fb90deb2.js"><link rel="prefetch" href="/assets/js/layout-NotFound.63ebdf35.js"><link rel="prefetch" href="/assets/js/layout-Slide.f1754089.js"><link rel="prefetch" href="/assets/js/page-About--5b67d57c.3eb9f23c.js"><link rel="prefetch" href="/assets/js/page-DockerInstallsoftware--8b695bc0.ed14c034.js"><link rel="prefetch" href="/assets/js/page-Dockerdeployment--35402470.78806ada.js"><link rel="prefetch" href="/assets/js/page-Docker学习笔记--1e1346ee.43e48072.js"><link rel="prefetch" href="/assets/js/page-Dubbo笔记--d33a24fc.5194ba9d.js"><link rel="prefetch" href="/assets/js/page-EasyExcel导入导出Excel--8536b204.27c8f2ab.js"><link rel="prefetch" href="/assets/js/page-ElasticSearch笔记--4af8c97c.43487c47.js"><link rel="prefetch" href="/assets/js/page-ElasticSearch面试--08e46102.867e3d7a.js"><link rel="prefetch" href="/assets/js/page-Git笔记--74fd8102.1027e717.js"><link rel="prefetch" href="/assets/js/page-Golang-介绍和使用--3c13b802.56cafd48.js"><link rel="prefetch" href="/assets/js/page-Golang-语法基础--73680002.587681d1.js"><link rel="prefetch" href="/assets/js/page-Hadoop伪分布式配置--2a57517c.57ca0f53.js"><link rel="prefetch" href="/assets/js/page-Home--59130159.32f4763d.js"><link rel="prefetch" href="/assets/js/page-HttpServletrequest与HttpServletResponse--32be633c.3ea1f88f.js"><link rel="prefetch" href="/assets/js/page-IDEA初始化SpringBoot项目+逆向工程+配置--cae6bdf8.0960681f.js"><link rel="prefetch" href="/assets/js/page-JVM--5b6ae8ec.4c68adf7.js"><link rel="prefetch" href="/assets/js/page-JVM-类加载子系统--1c575f64.e8e09775.js"><link rel="prefetch" href="/assets/js/page-JVM-运行时数据区--1b82f764.5ce6e700.js"><link rel="prefetch" href="/assets/js/page-JWT认证原理(更新中)--681a8776.6813b8ad.js"><link rel="prefetch" href="/assets/js/page-Java-IO--175f83c6.38efec5b.js"><link rel="prefetch" href="/assets/js/page-Java-String--451ab620.2fc5827a.js"><link rel="prefetch" href="/assets/js/page-Java-UML类图--5c22e12c.33a4bcf1.js"><link rel="prefetch" href="/assets/js/page-Java-基础知识笔记--1af93aac.8901c7bd.js"><link rel="prefetch" href="/assets/js/page-Java-基础面试题--54820d7c.0b2ce6be.js"><link rel="prefetch" href="/assets/js/page-Java-多线程并发--31fe9d0a.3e9b3826.js"><link rel="prefetch" href="/assets/js/page-Java-常用方法汇总--05020b62.5af9ee6e.js"><link rel="prefetch" href="/assets/js/page-Java-新特性--6be28b66.7d58be9f.js"><link rel="prefetch" href="/assets/js/page-Java-注解和反射--3822d062.9da3ddcf.js"><link rel="prefetch" href="/assets/js/page-Java-设计模式--6c560cae.3b46c30b.js"><link rel="prefetch" href="/assets/js/page-Java-集合容器--2c3e3402.a247f003.js"><link rel="prefetch" href="/assets/js/page-JavaScript面试题--d2217ec8.9cf4ccd7.js"><link rel="prefetch" href="/assets/js/page-JavaSwing-超市系统--26fb3520.f14e3856.js"><link rel="prefetch" href="/assets/js/page-Javaweb大学活动管理系统--43580be2.6ec8f75b.js"><link rel="prefetch" href="/assets/js/page-Java多线程-1--1aca6942.9e90ced0.js"><link rel="prefetch" href="/assets/js/page-Java多线程-2--0e28e800.8cd72499.js"><link rel="prefetch" href="/assets/js/page-Java多线程-JUC使用--f046a618.cd53fa7a.js"><link rel="prefetch" href="/assets/js/page-Java多线程-关键字锁--e825225c.b1c278a6.js"><link rel="prefetch" href="/assets/js/page-Java学习目录--60ce0d09.eee97e4f.js"><link rel="prefetch" href="/assets/js/page-Java面试整理--1bcb1346.e811a122.js"><link rel="prefetch" href="/assets/js/page-Linux学习目录--e7a528e2.41f1bd3f.js"><link rel="prefetch" href="/assets/js/page-Linux常用命令--0e00a956.38c55e4d.js"><link rel="prefetch" href="/assets/js/page-Linux技巧--b44e087c.ce5a4984.js"><link rel="prefetch" href="/assets/js/page-Markdown增强--7e4e51ec.e317d8a6.js"><link rel="prefetch" href="/assets/js/page-Maven笔记--5989c584.e917ba53.js"><link rel="prefetch" href="/assets/js/page-MyProject--ebe6f4ee.0f231392.js"><link rel="prefetch" href="/assets/js/page-Mybatis-Plus基础笔记--2b1fd47c.20bca26c.js"><link rel="prefetch" href="/assets/js/page-Mybatis基础笔记--575c8762.3324e72b.js"><link rel="prefetch" href="/assets/js/page-Mybatis语法笔记--2048b342.86318652.js"><link rel="prefetch" href="/assets/js/page-Mybatis逆向工程Example类使用--2302d0a2.836969a0.js"><link rel="prefetch" href="/assets/js/page-Mysql理论学习笔记--f8fff61c.5c599d29.js"><link rel="prefetch" href="/assets/js/page-Nginx-动静分离--3bdf05d4.1e8b5c36.js"><link rel="prefetch" href="/assets/js/page-Nginx-反向代理--5a698966.d3df8912.js"><link rel="prefetch" href="/assets/js/page-Nginx-负载均衡--6f6856a2.a5290c7b.js"><link rel="prefetch" href="/assets/js/page-Nginx基础笔记和安装配置--2dd310e8.36ff61c0.js"><link rel="prefetch" href="/assets/js/page-Nginx学习目录--5d803bc3.4a7b342d.js"><link rel="prefetch" href="/assets/js/page-Promise异步调用--26c7ec02.21440666.js"><link rel="prefetch" href="/assets/js/page-Redis应用场景--13936b64.5fbc672a.js"><link rel="prefetch" href="/assets/js/page-Redis理论学习笔记--dccd4764.9291ef7c.js"><link rel="prefetch" href="/assets/js/page-Redis部署与基本使用--042fe622.545324ee.js"><link rel="prefetch" href="/assets/js/page-Redis集群和哨兵--7310b8a2.50fa8ee4.js"><link rel="prefetch" href="/assets/js/page-SQL学习笔记--2196c73c.63285ae8.js"><link rel="prefetch" href="/assets/js/page-Spring-RestTemplate--120468b6.862d61dc.js"><link rel="prefetch" href="/assets/js/page-SpringBootVue项目搭建(持续更新)--7bda1ca2.21350296.js"><link rel="prefetch" href="/assets/js/page-SpringCloud笔记--59a0fafc.0405f8ee.js"><link rel="prefetch" href="/assets/js/page-SpringSecurity--43f5f362.be185ea2.js"><link rel="prefetch" href="/assets/js/page-Spring基础笔记--a33487fc.e46aa9e9.js"><link rel="prefetch" href="/assets/js/page-Spring注解--44ca7b34.be5298ef.js"><link rel="prefetch" href="/assets/js/page-Spring错误坑记录--c5e621d4.f96b6c80.js"><link rel="prefetch" href="/assets/js/page-Spring错误笔记--a8357668.f3671729.js"><link rel="prefetch" href="/assets/js/page-Spring面试题--2130907c.91f6925a.js"><link rel="prefetch" href="/assets/js/page-Swagger使用--596da9d4.ae66625e.js"><link rel="prefetch" href="/assets/js/page-主要功能与配置演示--8640dd82.d1505257.js"><link rel="prefetch" href="/assets/js/page-修改Host以访问Github--5c5d20f8.237a57dd.js"><link rel="prefetch" href="/assets/js/page-前端学习目录--41b2b489.9b7d9e96.js"><link rel="prefetch" href="/assets/js/page-听歌识曲开放平台--2bb96544.480879bf.js"><link rel="prefetch" href="/assets/js/page-大三下实训期末作业--13a0afc2.bf815300.js"><link rel="prefetch" href="/assets/js/page-字节测开面经--015c16c2.09005bcc.js"><link rel="prefetch" href="/assets/js/page-学习路线--5270a45e.cf4b51f7.js"><link rel="prefetch" href="/assets/js/page-实验室出入管理小程序--276ebfb4.53606f36.js"><link rel="prefetch" href="/assets/js/page-密码加密的文章--308fd1a2.c8715deb.js"><link rel="prefetch" href="/assets/js/page-操作系统--93f406bc.ccfcfd47.js"><link rel="prefetch" href="/assets/js/page-数据库学习目录--739cb729.7d1105a8.js"><link rel="prefetch" href="/assets/js/page-数据结构--3a868e62.6947e50e.js"><link rel="prefetch" href="/assets/js/page-数据结构算法学习目录--67791793.43e2b207.js"><link rel="prefetch" href="/assets/js/page-数据结构算法题目合集--9708ba24.047fc2f8.js"><link rel="prefetch" href="/assets/js/page-服务器上部署SpringBoot--311ff162.94668636.js"><link rel="prefetch" href="/assets/js/page-概述参考--89ff9fa6.47ca090e.js"><link rel="prefetch" href="/assets/js/page-概述参考--c6980c9e.06961427.js"><link rel="prefetch" href="/assets/js/page-用xshell连接虚拟机中的Centos7--15553b3c.043bf8c7.js"><link rel="prefetch" href="/assets/js/page-算法--3f0414a2.e6fdc55e.js"><link rel="prefetch" href="/assets/js/page-组件禁用--4e03d17c.15fd9db5.js"><link rel="prefetch" href="/assets/js/page-腾讯云学习笔记--5514f34e.dcaf086e.js"><link rel="prefetch" href="/assets/js/page-计算机网络--1420283a.a19623c9.js"><link rel="prefetch" href="/assets/js/page-认识SpringCloud--21ac1f18.e4a02a0f.js"><link rel="prefetch" href="/assets/js/page-认识SpringCloud--353c867c.6f546fee.js"><link rel="prefetch" href="/assets/js/page-设计模式七大原则--4fb9d7fc.4bcfc396.js"><link rel="prefetch" href="/assets/js/page-设计模式七大原则--96b59c3c.34def586.js"><link rel="prefetch" href="/assets/js/page-设计模式之J2EE设计模式--74fd2740.9841eb79.js"><link rel="prefetch" href="/assets/js/page-设计模式之创建型设计模式--421acabc.2c5da3a6.js"><link rel="prefetch" href="/assets/js/page-设计模式之结构型设计模式--07616382.b449c529.js"><link rel="prefetch" href="/assets/js/page-设计模式之行为型设计模式--4a4af782.b6077a7b.js"><link rel="prefetch" href="/assets/js/page-问题随记--24fbad02.1ccb6e44.js"><link rel="prefetch" href="/assets/js/page-面试大纲--02c57342.bb931b02.js"><link rel="prefetch" href="/assets/js/page-页面配置--483f41ca.769e07be.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.e14a9ba9.js"><link rel="prefetch" href="/assets/js/vendors~photo-swipe.52b3d02d.js"><link rel="prefetch" href="/assets/js/vendors~reveal.af77f405.js"><link rel="prefetch" href="/assets/js/vendors~valine.910d88fc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ee34f577.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-anchor"><header class="navbar"><button class="sidebar-button"><span class="icon"></span></button> <a href="/" class="home-link router-link-active"><img src="https://cdn.jsdelivr.net/gh/lifealsoisgg/Blog@gh-pages/logo.png" alt="Draco's Blog" class="logo"> <!----> <span class="site-name can-hide">Draco's Blog</span></a> <div class="links"><button class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">主题色:</label> <li><a href="#" class="default-theme"></a></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">主题模式:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0042.667-42.667V128a42.667 42.667 0 00-85.334 0v85.333A42.667 42.667 0 00512 256zm384 213.333h-85.333a42.667 42.667 0 000 85.334H896a42.667 42.667 0 000-85.334zM256 512a42.667 42.667 0 00-42.667-42.667H128a42.667 42.667 0 000 85.334h85.333A42.667 42.667 0 00256 512zm9.387-298.667a42.667 42.667 0 00-59.307 62.72l61.44 59.307a42.667 42.667 0 0031.147 11.947 42.667 42.667 0 0030.72-13.227 42.667 42.667 0 000-60.16zm459.946 133.974a42.667 42.667 0 0029.44-11.947l61.44-59.307a42.667 42.667 0 00-57.6-62.72l-61.44 60.587a42.667 42.667 0 000 60.16 42.667 42.667 0 0028.16 13.227zM512 768a42.667 42.667 0 00-42.667 42.667V896a42.667 42.667 0 0085.334 0v-85.333A42.667 42.667 0 00512 768zm244.48-79.36a42.667 42.667 0 00-59.307 61.44l61.44 60.587a42.667 42.667 0 0029.44 11.946 42.667 42.667 0 0030.72-12.8 42.667 42.667 0 000-60.586zm-488.96 0l-61.44 59.307a42.667 42.667 0 000 60.586 42.667 42.667 0 0030.72 12.8 42.667 42.667 0 0028.587-10.666l61.44-59.307a42.667 42.667 0 00-59.307-61.44zM512 341.333A170.667 170.667 0 10682.667 512 170.667 170.667 0 00512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 00-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 00-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/category/" class="nav-link"><i class="iconfont icon-note"></i>
  分类
</a></div><div class="nav-item"><a href="/study-line/" class="nav-link"><i class="iconfont icon-info"></i>
  学习路线
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont icon-time"></i>
  时间线
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont icon-info"></i>
  关于
</a></div><div class="nav-item"><a href="https://photos.lifeisgg.online/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont icon-emoji"></i>
  相册
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a rel="noopener noreferrer" href="https://github.com/LifeAlsoIsGG" target="_blank" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <nav class="nav-links"><div class="nav-item"><a href="/category/" class="nav-link"><i class="iconfont icon-note"></i>
  分类
</a></div><div class="nav-item"><a href="/study-line/" class="nav-link"><i class="iconfont icon-info"></i>
  学习路线
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont icon-time"></i>
  时间线
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont icon-info"></i>
  关于
</a></div><div class="nav-item"><a href="https://photos.lifeisgg.online/" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont icon-emoji"></i>
  相册
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a rel="noopener noreferrer" href="https://github.com/LifeAlsoIsGG" target="_blank" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/study-line/" class="sidebar-link"><i class="iconfont icon-info" style="margin-right:0.2em;"></i>学习路线</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>My-Project</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>面试</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-code"></i> <span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Golang</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>SpringCloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Mybatis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>数据结构&amp;算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>ElasticSearch</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Nginx</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable open"><i class="iconfont icon-creative"></i> <span>消息队列</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable open"><i class="iconfont icon-creative"></i> <span>RabbitMQ</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/MQ/RabbitMQ/RabbitMQ/" aria-current="page" class="active sidebar-link">RabbitMQ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#大纲" class="sidebar-link">大纲</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#参考" class="sidebar-link">参考</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#什么是消息中间件" class="sidebar-link">什么是消息中间件</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#消息中间件作用" class="sidebar-link">消息中间件作用</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#rabbitmq特点" class="sidebar-link">RabbitMQ特点</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#常用消息中间件" class="sidebar-link">常用消息中间件</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#rabbitmq入门" class="sidebar-link">RabbitMQ入门</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#核心概念" class="sidebar-link">核心概念</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器类型" class="sidebar-link">交换器类型</a></li></ul></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#客户端开发向导" class="sidebar-link">客户端开发向导</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#连接" class="sidebar-link">连接</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#使用交换器和队列" class="sidebar-link">使用交换器和队列</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器声明方法属性" class="sidebar-link">交换器声明方法属性</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#队列申明方法属性" class="sidebar-link">队列申明方法属性</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器队列绑定方法属性" class="sidebar-link">交换器队列绑定方法属性</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器与交换器绑定" class="sidebar-link">交换器与交换器绑定</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#发送消息方法属性" class="sidebar-link">发送消息方法属性</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#消费消息" class="sidebar-link">消费消息</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#消息端确认与拒绝autoack" class="sidebar-link">消息端确认与拒绝autoAck</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#关闭连接" class="sidebar-link">关闭连接</a></li></ul></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#消息何去何从" class="sidebar-link">消息何去何从</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#mandatory-immediate" class="sidebar-link">mandatory&amp;immediate</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#mandatory" class="sidebar-link">mandatory</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#immediate" class="sidebar-link">immediate</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#备份交换机" class="sidebar-link">备份交换机</a></li></ul></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#过期时间-ttl" class="sidebar-link">过期时间(TTL)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#设置消息ttl" class="sidebar-link">设置消息TTL</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#设置队列ttl" class="sidebar-link">设置队列TTL</a></li></ul></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#死信队列" class="sidebar-link">死信队列</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#消息成为死信的情况" class="sidebar-link">消息成为死信的情况</a></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#示例" class="sidebar-link">示例</a></li></ul></li><li class="sidebar-sub-header"><a href="/MQ/RabbitMQ/RabbitMQ/#延迟队列" class="sidebar-link">延迟队列</a></li></ul></li><li><!----></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>错误笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Github</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-creative"></i> <span>Guide</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/about/" class="sidebar-link"><i class="iconfont icon-info" style="margin-right:0.2em;"></i>About</a></li></ul> </aside> <main class="page"><nav class="breadcrumb disable"><!----></nav>  <div class="page-title"><h1><!---->
    RabbitMQ
  </h1> <div class="page-info"><!----> <span aria-label="作者🖊" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span>Draco</span></span><span aria-label="访问量🔢" data-balloon-pos="down" class="visitor-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon eye-icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z" fill="currentColor"></path></svg> <span id="/MQ/RabbitMQ/RabbitMQ/" data-flag-title="RabbitMQ" class="leancloud_visitors"><span class="leancloud-visitors-count">...</span></span></span><span aria-label="写作日期📅" data-balloon-pos="down" class="time-info"><svg viewBox="0 0 1030 1024" xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z" fill="currentColor"></path></svg> <span>2021-08-13 00:04:05</span></span><!----><span aria-label="标签🏷" data-balloon-pos="down"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon tag-icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z" fill="currentColor"></path></svg> <ul class="tags-wrapper"><li class="tag clickable tag0"><span role="navigation">消息队列</span></li><li class="tag clickable tag1"><span role="navigation">RabbitMQ</span></li></ul></span><span aria-label="阅读时间⌛" data-balloon-pos="down" class="read-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon time-icon"><path d="M511.997 70.568c-243.797 0-441.429 197.633-441.429 441.435 0 243.797 197.632 441.429 441.43 441.429S953.431 755.8 953.431 512.002c0-243.796-197.637-441.434-441.435-441.434zm150.158 609.093l-15.605 15.61c-8.621 8.615-22.596 8.615-31.215 0L472.197 552.126c-4.95-4.944-4.34-14.888-4.34-24.677V247.14c0-12.19 9.882-22.07 22.07-22.07h22.07c12.19 0 22.07 9.882 22.07 22.07v273.218l128.088 128.088c8.62 8.62 8.62 22.595 0 31.215zm0 0" fill="currentColor"></path></svg> <span>大约 28 分钟</span></span></div> <hr></div> <!----> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"><ul class="anchor-list"><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#大纲" class="anchor-link"><div>大纲</div></a></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#参考" class="anchor-link"><div>参考</div></a></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#什么是消息中间件" class="anchor-link"><div>什么是消息中间件</div></a></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#消息中间件作用" class="anchor-link"><div>消息中间件作用</div></a></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#rabbitmq特点" class="anchor-link"><div>RabbitMQ特点</div></a></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#常用消息中间件" class="anchor-link"><div>常用消息中间件</div></a></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#rabbitmq入门" class="anchor-link"><div>RabbitMQ入门</div></a><ul class="anchor-list"><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#介绍" class="anchor-link"><div>介绍</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#核心概念" class="anchor-link"><div>核心概念</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器类型" class="anchor-link"><div>交换器类型</div></a></li></ul></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#客户端开发向导" class="anchor-link"><div>客户端开发向导</div></a><ul class="anchor-list"><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#连接" class="anchor-link"><div>连接</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#使用交换器和队列" class="anchor-link"><div>使用交换器和队列</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器声明方法属性" class="anchor-link"><div>交换器声明方法属性</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#队列申明方法属性" class="anchor-link"><div>队列申明方法属性</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器队列绑定方法属性" class="anchor-link"><div>交换器队列绑定方法属性</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#交换器与交换器绑定" class="anchor-link"><div>交换器与交换器绑定</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#发送消息方法属性" class="anchor-link"><div>发送消息方法属性</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#消费消息" class="anchor-link"><div>消费消息</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#消息端确认与拒绝autoack" class="anchor-link"><div>消息端确认与拒绝autoAck</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#关闭连接" class="anchor-link"><div>关闭连接</div></a></li></ul></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#消息何去何从" class="anchor-link"><div>消息何去何从</div></a><ul class="anchor-list"><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#mandatory-immediate" class="anchor-link"><div>mandatory&amp;immediate</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#mandatory" class="anchor-link"><div>mandatory</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#immediate" class="anchor-link"><div>immediate</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#备份交换机" class="anchor-link"><div>备份交换机</div></a></li></ul></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#过期时间-ttl" class="anchor-link"><div>过期时间(TTL)</div></a><ul class="anchor-list"><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#设置消息ttl" class="anchor-link"><div>设置消息TTL</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#设置队列ttl" class="anchor-link"><div>设置队列TTL</div></a></li></ul></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#死信队列" class="anchor-link"><div>死信队列</div></a><ul class="anchor-list"><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#消息成为死信的情况" class="anchor-link"><div>消息成为死信的情况</div></a></li><li class="anchor anchor3"><a href="/MQ/RabbitMQ/RabbitMQ/#示例" class="anchor-link"><div>示例</div></a></li></ul></li><li class="anchor anchor2"><a href="/MQ/RabbitMQ/RabbitMQ/#延迟队列" class="anchor-link"><div>延迟队列</div></a></li></ul></div></aside></div> <div class="theme-default-content content__default"><h2 id="大纲"><a href="#大纲" class="header-anchor">#</a> 大纲</h2> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/RabbitMQ.png" alt="RabbitMQ大纲"></p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li>尚硅谷</li> <li>https://zhangc233.github.io/2021/07/23/RabbitMQ/</li> <li>《RabbitMQ实战指南》</li></ul> <h2 id="什么是消息中间件"><a href="#什么是消息中间件" class="header-anchor">#</a> 什么是消息中间件</h2> <p>消息、（Message）是指在应用间传送的数据。消息可以非常简单，比如只包含文本字符串、JSON等，也可以很复杂，比如内嵌对象。</p> <p>消息队列中间件（Message Queue Middleware，简称为MQ）是指利用高效可靠的消息传递机制进行与平台无关的数据交流，并基于数据通信来进行分布式系统的集成。通过提供消息传递和消息排队模型，它可以在分布式环境下扩展进程间的通信。</p> <p>消息队列中间件，也可以称为消息队列或者消息中间件。它一般有两种传递模式：点对点（PP，Point-to-Point）模式和发布/订阅（Pub/Sub）模式。</p> <ul><li>点对点模式是基于队列的，消息生产者发送消息到队列，消息消费者从队列中接收消息，队列的存在使得消息的异步传输成为可能。</li> <li>发布订阅模式定义了如何向一个内容节点发布和订阅消息，这个内容节点称为主题（topic），主题可以认为是消息传递的中介，消息发布者将消息发布到某个主题，而消息订阅者则从主题中订阅消息。主题使得消息的订阅者与消息的发布者互相保持独立，不需要进行接触即可保证消息的传递，发布/订阅模式在消息的一对多广播时采用。</li></ul> <h2 id="消息中间件作用"><a href="#消息中间件作用" class="header-anchor">#</a> 消息中间件作用</h2> <ul><li>解耦：在项目启动之初来预测将来会碰到什么需求是极其困难的。消息中间件在处理过程中间插入了一个隐含的、基于数据的接口层，两边的处理过程都要实现这一接口，这允许你独立地扩展或修改两边的处理过程，只要确保它们遵守同样的接口约束即可。</li> <li>冗余（存储）：有些情况下，处理数据的过程会失败。消息中间件可以把数据进行持久化直到它们已经被完全处理，通过这一方式规避了数据丢失风险。在把一个消息从消息中间件中删除之前，需要你的处理系统明确地指出该消息已经被处理完成，从而确保你的数据被安全地保存直到你使用完毕。</li> <li>扩展性：因为消息中间件解耦了应用的处理过程，所以提高消息入队和处理的效率是很容易的，只要另外增加处理过程即可，不需要改变代码，也不需要调节参数。</li> <li>削峰：在访问量剧增的情况下，应用仍然需要继续发挥作用，但是这样的突发流量并不常见。如果以能处理这类峰值为标准而投入资源，无疑是巨大的浪费。使用消息中间件能够使关键组件支撑突发访问压力，不会因为突发的超负荷请求而完全崩溃。</li> <li>可恢复性：当系统一部分组件失效时，不会影响到整个系统。消息中间件降低了进程间的耦合度，所以即使一个处理消息的进程挂掉，加入消息中间件中的消息仍然可以在系统恢复后进行处理。
顺序保证：在大多数使用场景下，数据处理的顺序很重要，大部分消息中间件支持一定程度上的顺序性。</li> <li>缓冲：在任何重要的系统中，都会存在需要不同处理时间的元素。消息中间件通过一个缓冲层来帮助任务最高效率地执行，写入消息中间件的处理会尽可能快速。该缓冲层有助于控制和优化数据流经过系统的速度。</li> <li>异步通信：在很多时候应用不想也不需要立即处理消息。消息中间件提供了异步处理机制，允许应用把一些消息放入消息中间件中，但并不立即处理它，在之后需要的时候再慢慢处理。</li></ul> <h2 id="rabbitmq特点"><a href="#rabbitmq特点" class="header-anchor">#</a> RabbitMQ特点</h2> <ul><li>可靠性：RabbitMQ使用一些机制来保证可靠性，如持久化、传输确认及发布确认等。</li> <li>灵活的路由：在消息进入队列之前，通过交换器来路由消息。对于典型的路由功能，RabbitMQ已经提供了一些内置的交换器来实现。针对更复杂的路由功能，可以将多个交换器绑定在一起，也可以通过插件机制来实现自己的交换器。</li></ul> <h2 id="常用消息中间件"><a href="#常用消息中间件" class="header-anchor">#</a> 常用消息中间件</h2> <ul><li><p>ActiveMQ
优点：单机吞吐量万级，时效性 ms 级，可用性高，基于主从架构实现高可用性，较低的概率丢失数据。</p> <p>缺点：官方社区现在对 ActiveMQ 5.x 维护越来越少，高吞吐量场景较少使用。</p></li> <li><p>Kafka
大数据的杀手锏，谈到大数据领域内的消息传输，则绕不开 Kafka，这款为大数据而生的消息中间件，以其百万级 TPS 的吞吐量名声大噪，迅速成为大数据领域的宠儿，在数据采集、传输、存储的过程中发挥着举足轻重的作用。目前已经被 LinkedIn，Uber, Twitter, Netflix 等大公司所采纳。</p> <p>优点：性能卓越，单机写入 TPS 约在百万条 / 秒，最大的优点，就是吞吐量高。时效性 ms 级，可用性非常高，kafka 是分布式的，一个数据多个副本，少数机器宕机，不会丢失数据，不会导致不可用，消费者采用 Pull 方式获取消息，消息有序，通过控制能够保证所有消息被消费且仅被消费一次；有优秀的第三方 Kafka Web 管理界面 Kafka-Manager；在日志领域比较成熟，被多家公司和多个开源项目使用；功能支持：功能较为简单，主要支持简单的 MQ 功能，在大数据领域的实时计算以及日志采集被大规模使用。</p> <p>缺点：Kafka 单机超过 64 个队列 / 分区，Load 会发生明显的飙高现象，队列越多，load 越高，发送消息响应时间变长，使用短轮询方式，实时性取决于轮询间隔时间，消费失败不支持重试；支持消息顺序，但是一台代理宕机后，就会产生消息乱序，社区更新较慢。</p></li> <li><p>RocketMQ
RocketMQ 出自阿里巴巴的开源产品，用 Java 语言实现，在设计时参考了 Kafka，并做出了自己的一 些改进。被阿里巴巴广泛应用在订单，交易，充值，流计算，消息推送，日志流式处理，binglog 分发等场景。</p> <p>优点：单机吞吐量十万级，可用性非常高，分布式架构，消息可以做到 0 丢失，MQ 功能较为完善，还是分布式的，扩展性好，支持 10 亿级别的消息堆积，不会因为堆积导致性能下降。</p> <p>缺点：支持的客户端语言不多，目前是 java 及 c++，其中 c++ 不成熟；社区活跃度一般，没有在 MQ 核心中去实现 JMS 等接口，有些系统要迁移需要修改大量代码。</p></li> <li><p>RabbitMQ
2007 年发布，是一个在 AMQP (高级消息队列协议) 基础上完成的，可复用的企业消息系统，是当前最主流的消息中间件之一。</p> <p>优点：由于 erlang 语言的高并发特性，性能较好；吞吐量到万级，MQ 功能比较完备，健壮、稳定、易用、跨平台、支持多种语言。如：Python、Ruby、.NET、Java、JMS、C、PHP、ActionScript、XMPP、STOMP 等，AJAX 文档齐全；开源提供的管理界面非常棒，用起来很好用，社区活跃度高；更新频率相当高。</p> <p>缺点：商业版需要收费，学习成本较高。</p></li></ul> <p>作者: zhangc233
链接: https://zhangc233.github.io/2021/07/23/RabbitMQ/#MQ-%E7%9A%84%E5%88%86%E7%B1%BB
来源: ZC的学习录</p> <h2 id="rabbitmq入门"><a href="#rabbitmq入门" class="header-anchor">#</a> RabbitMQ入门</h2> <h3 id="介绍"><a href="#介绍" class="header-anchor">#</a> 介绍</h3> <p>RabbitMO整体上是一个生产者与消费者模型，主要负责接收、存储和转发消息。可以把消息传递的过程想象成：当你将一个包裹送到邮局，邮局会暂存并最终将邮件通过邮递员送到收件人的手上，RabbitMQ就好比由邮局、邮箱和邮递员组成的一个系统。从计算机术语层面来说，RabbitMQ模型更像是一种交换机模型。</p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/RabbitMQ%E6%A8%A1%E5%9E%8B%E6%9E%B6%E6%9E%84.png" alt=""></p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/RabbitMQ%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86png" alt="RabbitMQ-00000007"></p> <h3 id="核心概念"><a href="#核心概念" class="header-anchor">#</a> 核心概念</h3> <ul><li>Producer：生产者创建消息，然后发布到RabbitMO中。消息一般可以包含2个部分：<strong>消息体和标签（Label）</strong>。消息体也可以称之为<strong>payload</strong>，在实际应用中，消息体一般是一个带有业务逻辑结构的数据，比如一个JON字符串。当然可以进一步对这个消息体进行序列化操作。消息的标签用来表述这条消息，比如一个交换器的名称和一个路由键。生产者把消息交由RabbitMQ，RabbitMQ之后会根据标签把消息发送给感兴趣的消费者（Consumer）。</li> <li>Consumer：消费者，就是接收消息的一方。消费者连接到RabbitMQ服务器，并订阅到队列上。当消费者消费一条消息时，只是消费消息的消息体（payload）。在消息路由的过程中，<strong>消息的标签会丢弃</strong>，存入到队列中的消息只有消息体，<strong>消费者也只会消费到消息体，也就不知道消息的生产者是谁</strong>，当然消费者也不需要知道。</li> <li>Broker：消息中间件的服务节点。对于RabbitMQ来说，一个RabbitMQ Broker可以简单地看作一个RabbitMQ服务节点，或者RabbitMQ服务实例。大多数情况下也可以将一个RabbitMQ Broker看作一台RabbitMQ服务器。</li></ul> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97%E7%94%9F%E4%BA%A7%E6%B6%88%E8%B4%B9%E6%B5%81%E7%A8%8B.png" alt="image-20220101153843047"></p> <ul><li><p>Connection：publisher／consumer 和 broker 之间的 TCP 连接。</p></li> <li><p>Channel：如果每一次访问 RabbitMQ 都建立一个 Connection，在消息量大的时候建立 TCP Connection 的开销将是巨大的，效率也较低。Channel 是在 connection 内部建立的逻辑连接，如果应用程序支持多线程，通常每个 thread 创建单独的 channel 进行通讯，AMQP method 包含了 channel id 帮助客户端和 message broker 识别 channel，所以 channel 之间是完全隔离的。Channel 作为轻量级的 Connection 极大减少了操作系统建立 TCP connection 的开销。</p></li></ul> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E8%BF%9E%E6%8E%A5%E5%92%8C%E4%BF%A1%E9%81%93.png" alt="image-20220101212952076"></p> <ul><li><p>Queue：用于存储消息用于存储消息</p></li> <li><p>Exchange：交换器。在图2-中我们暂时可以理解成生产者将消息投递到队列中，实际上这个在RabbitMQ中不会发生。真实情况是，生产者将消息发送到Exchange（交换器，通常也可以用大写的“Ⅹ”来表示），由交换器将消息路由到一个或者多个队列中。如果路由不到，或许会返回给生产者，或许直接丢弃。有四种交换器</p></li> <li><p>RoutingKey：路由键。生产者将消息发给交换器的时候，一般会指定一个RoutingKey，用来指定这个消息的路由规则，而这个Routing Key需要与交换器类型和绑定键（BindingKey）联合使用才能最终生效。在交换器类型和绑定键（BindingKey）固定的情况下，生产者可以在发送消息给交换器时，通过指定RoutingKey来决定消息流向哪里。</p></li> <li><p>Binding：绑定。RabbitMQ中通过绑定将交换器与队列关联起来，在绑定的时候一般会指定一个绑定键BindingKey</p></li></ul> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E7%BB%91%E5%AE%9A.png" alt="image-20220101155411425"></p> <p>生产者将消息发送给交换器时，需要一个RoutingKey，<strong>当BindingKey和RoutingKey相匹配时，消息会被路由到对应的队列中</strong>。在绑定多个队列到同一个交换器的时候，这些绑定允许使用相同的BindingKey。BindingKey并不是在所有的情况下都生效，它依赖于交换器类型，比如fanout类型的交换器就会无视BindingKey，而是将消息路由到所有绑定到该交换器的队列中。</p> <p>路由键和绑定</p> <ul><li>在使用绑定的时候，其中需要的路由键是BindingKey。涉及的客户端方法如：channel.exchangeBind、channel.queueBind，对应的AMQP命令（详情参见
2.2节）为Exchange.Bind、Queue.Bind。</li> <li>在发送消息的时候，其中需要的路由键是RoutingKey。涉及的客户端方法如
channel.basicPublish，对应的AMQ命令为Basic.Publish。</li></ul> <h3 id="交换器类型"><a href="#交换器类型" class="header-anchor">#</a> 交换器类型</h3> <ul><li>fanout：它会把所有发送到该交换器的消息路由到所有与该交换器绑定的队列中。</li> <li>direct：它会把消息路由到那些BindingKey和RoutingKey完全匹配的队列中。</li> <li>topic：也是消息路由到绑定和路由相匹配的队列，但不同的是
<ul><li>RoutingKey为一个点号“.”分隔的字符串（被点号“.”分隔开的每一段独立的字符串称为一个单词），如“com.rabbitmq.client'”、“java.util.concurrent”、“com.hidden.client”；</li> <li>BindingKey和RoutingKey一样也是点号“.”分隔的字符串；</li> <li>BindingKey中可以存在两种特殊字符串a星号和“#”，用于做模糊匹配，其中星号用于匹配一个单词，”#“用于匹配多个</li></ul></li> <li>headers：headers类型的交换器不依赖于路由键的匹配规则来路由消息，而是根据发送的消息内容中的headers属性进行匹配。在绑定队列和交换器时制定一组键值对，当发送消息到交换器时，RabbitMQ会获取到该消息的headers（也是一个键值对的形式），对比其中的键值对是否完全匹配队列和交换器绑定时指定的键值对，如果完全匹配则消息会路由到该队列，否则不会路由到该队列。headers类型的交换器性能会很差，而且也不实用，基本上不会看到它的存在。</li></ul> <p>topic举例</p> <ul><li>路由键为“com.rabbitmg.client”的消息会同时路由到Queuel和Queue2；</li> <li>路由键为“com.hidden.client”的消息只会路由到Queue2中；</li> <li>路由键为“com.hidden.demo”的消息只会路由到Queue2中；</li> <li>路由键为“java.rabbitmg.demo”的消息只会路由到Queuel中；</li> <li>路由键为“java.util.concurrent”的消息将会被丢弃或者返回给生产者（需要设置mandatory参数），因为它没有匹配任何路由键。</li></ul> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/topic%E8%B7%AF%E7%94%B1%E4%BA%A4%E6%8D%A2%E5%99%A8.png" alt=""></p> <h2 id="客户端开发向导"><a href="#客户端开发向导" class="header-anchor">#</a> 客户端开发向导</h2> <h3 id="连接"><a href="#连接" class="header-anchor">#</a> 连接</h3> <p>指定</p> <ul><li>IP</li> <li>HOST</li> <li>USERNAME</li> <li>PASSWORD</li></ul> <p>创建<strong>Connection</strong>，并创建<strong>Channel</strong>实例，Channel不能在线程间共享会有线程安全问题</p> <p>通过isOpen判断是否处于开启状态</p> <h3 id="使用交换器和队列"><a href="#使用交换器和队列" class="header-anchor">#</a> 使用交换器和队列</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//创建一个type=&quot;direct&quot;非排它非自动删除的交换器</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span>EXCHANGE_NAME<span class="token punctuation">,</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//创建一个持久化非排它非自动删除的交队列</span>
channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span>QUEUE_NAME<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//将交换器与队列通过路由键进行绑定</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>QUEUE_NAME<span class="token punctuation">,</span> EXCHANGE_NAME<span class="token punctuation">,</span> ROUTING_KEY<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>上面的代码也展示了如何使用路由键将队列和交换器绑定起来。</li> <li>上面声明的队列具备如下特性：只对当前应用中同一个Connection层面<code>可用</code>，同一个Connection的不同Channel可共用，并且也会在应用连接断开时自动删除。</li> <li>如果其他生产消费者声明一样的交换器或队列名字相同时只要属性相同就什么都不做，否则抛出异常</li></ul> <h3 id="交换器声明方法属性"><a href="#交换器声明方法属性" class="header-anchor">#</a> 交换器声明方法属性</h3> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E4%BA%A4%E6%8D%A2%E6%9C%BA%E6%96%B9%E6%B3%95%E5%B1%9E%E6%80%A7_1.png" alt="image-20220101231901431"></p> <blockquote><p>autoDelete指的是当交换器有绑定的队列或交换器，且与之解绑时且autoDelete为true时自动删除，而不是与客户端断开连接就删除</p></blockquote> <h3 id="队列申明方法属性"><a href="#队列申明方法属性" class="header-anchor">#</a> 队列申明方法属性</h3> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E9%98%9F%E5%88%97%E5%A3%B0%E6%98%8E%E5%B1%9E%E6%80%A7.png" alt="image-20220102001031566"></p> <blockquote><p>生产者和消费者都能够使用queueDeclare来声明一个队列，但是如果消费者在同一个信道上订阅了另一个队列，就无法再声明队列了。必须先取消订阅，然后将信道置为“传输”，才能声明队列</p></blockquote> <h3 id="交换器队列绑定方法属性"><a href="#交换器队列绑定方法属性" class="header-anchor">#</a> 交换器队列绑定方法属性</h3> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E4%BA%A4%E6%8D%A2%E5%99%A8%E9%98%9F%E5%88%97%E7%BB%91%E5%AE%9A%E6%96%B9%E6%B3%95%E5%B1%9E%E6%80%A7.png" alt="image-20220102002534960"></p> <h3 id="交换器与交换器绑定"><a href="#交换器与交换器绑定" class="header-anchor">#</a> 交换器与交换器绑定</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;source&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BuiltinExchangeType</span><span class="token punctuation">.</span>DIRECT<span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;destination&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BuiltinExchangeType</span><span class="token punctuation">.</span>FANOUT<span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">exchangeBind</span><span class="token punctuation">(</span><span class="token string">&quot;destination&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;source&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exKey&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span>channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;destination&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;source&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exKey&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">&quot;exToExDemo&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>生产者发送消息至交换器source中，交换器source根据路由键找到与其匹配的另一个交换器destination，并把消息转发到destination中，进而存储在destination绑定的队列queue中，可参考图3-1。</p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/i%E4%BA%A4%E6%8D%A2%E5%99%A8%E4%B8%8E%E4%BA%A4%E6%8D%A2%E5%99%A8%E7%BB%91%E5%AE%9A.png" alt="image-20220102003824898"></p> <h3 id="发送消息方法属性"><a href="#发送消息方法属性" class="header-anchor">#</a> 发送消息方法属性</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//发送属性示例</span>
channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span>EXCHANGE_NAME<span class="token punctuation">,</span> ROUTING_NAME<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">new</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token class-name">Maps</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">contentType</span><span class="token punctuation">(</span><span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">deliveryMode</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">priority</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">userId</span><span class="token punctuation">(</span><span class="token string">&quot;hidden&quot;</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">expiration</span><span class="token punctuation">(</span><span class="token string">&quot;6000&quot;</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;message_demo&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E6%96%B9%E6%B3%95%E5%B1%9E%E6%80%A7.png" alt="image-20220102183618810"></p> <h3 id="消费消息"><a href="#消费消息" class="header-anchor">#</a> 消费消息</h3> <p>RabbitMQ的消费模式分两种：</p> <ul><li>推（Push）模式：推模式采用Basic.Consume进行消费</li> <li>和拉（Pull）模式：拉模式则是调用Basic.Get进行消费</li></ul> <p>常用一个Channel对应一个消费者</p> <h4 id="推模式"><a href="#推模式" class="header-anchor">#</a> 推模式</h4> <p>推模式可以通过持续订阅的方式消费信息，相关类：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>rabbitmq<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">Consumer</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>rabbitmg<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token class-name">DefaultConsumer</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>接收消息一般通过实现Consumer接口或者继承DefaultConsumer类来实现。当调用与Consumer相关的API方法时，不同的订阅采用不同的消费者标签（consumerTag）来区分彼此，在同一个Channel中的消费者也需要通过唯一的消费者标签以作区分，关键消费代码如代码清单3-9所示。</p> <p>Channel类中的basicConsume方法有如下形式</p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E6%B6%88%E8%B4%B9%E6%B6%88%E6%81%AF%E6%8E%A8%E6%A8%A1%E5%BC%8F%E6%96%B9%E6%B3%95%E5%B1%9E%E6%80%A7.png" alt="image-20220102200123744"></p> <h4 id="拉模式"><a href="#拉模式" class="header-anchor">#</a> 拉模式</h4> <p>这里讲一下拉模式的消费方式。通过channel.basicGet方法可以单条地获取消息，其返回值是GetRespone。Channel类的basicGet方法没有其他重载方法，只有：
GetResponse basicGet (String queue,boolean autoAck)throws IOException;其中queue代表队列的名称，如果设置autoAck为false，那么同样需要调用channel.basicAck来确认消息已被成功接收。拉模式的关键代码如代码清单3-10所示。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">RabbitMqUtils</span><span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">GetResponse</span> response <span class="token operator">=</span> channel<span class="token punctuation">.</span><span class="token function">basicGet</span><span class="token punctuation">(</span>QUEUE<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//设置autoAck为false需要basicAck来确认消息接收成功</span>
channel<span class="token punctuation">.</span><span class="token function">basicAck</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getEnvelope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeliveryTag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>Basic.Consume将信道（Channel）置为接收模式即推模式，直到取消队列的订阅为止。在接收模式期间，RabbitMQ会不断地推送消息给消费者，当然推送消息的个数还是会受到Basic.Qos的限制。如果只想从队列获得单条消息而不是持续订阅，建议还是使用Basic.Get进行消费。但是不能将Basic.Get放在一个循环里来代替Basic.Consume，这样做会严重影响RabbitMQ的性能。如果要实现高吞吐量，消费者理应使用Basic.Consume方法。</p></blockquote> <h3 id="消息端确认与拒绝autoack"><a href="#消息端确认与拒绝autoack" class="header-anchor">#</a> 消息端确认与拒绝autoAck</h3> <p>为了保证消息从队列可靠地达到消费者，RabbitMQ提供了消息确认机制（messageacknowledgement）。消费者在订阅队列时，可以指定autoAck参数，</p> <ul><li>当autoAck等于false时，RabbitMQ会等待消费者显式地回复确认信号后才从内存（或者磁盘）中移去消息、（实质上是先打上删除标记，之后再删除）。</li> <li>当autoAck等于true时，RabbitMQ会自动把发送出去的消息置为确认，然后从内存（或者磁盘）中删除，而不管消费者是否真正地消费到了这些消息。</li></ul> <p>采用消息确认机制后，只要设置autoAck参数为false，消费者就有足够的时间处理消息（任务），不用担心处理消息过程中消费者进程挂掉后消息丢失的问题，因为RabbitMQ会一直等待持有消息直到消费者显式调用Basic.Ack命令为止。</p> <p>当autoAck参数置为false，对于RabbitMQ服务端而言，队列中的消息分成了两个部分：</p> <ul><li><p>一部分是等待投递给消费者的消息</p></li> <li><p>一部分是已经投递给消费者</p></li></ul> <p>但是还没有收到消费者确认信号的消息。如果RabbitMQ一直没有收到消费者的确认信号，并且消费此消息的消费者已经断开连接，则RabbitMQ会安排该消息重新进入队列，等待投递给下一个消费者，当然也有可能还是原来的那个消费者。且RabbitMQ不会为其设置过期时间</p> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E6%9F%A5%E7%9C%8Bready.png" alt="image-20220102212838391"></p> <h4 id="消息拒绝"><a href="#消息拒绝" class="header-anchor">#</a> 消息拒绝</h4> <p>RabbitMQ在2.O.0版本开始引入了Basic.Reject这个命令，消费者客户端可以调用与其对应的channel.basicReject方法来告诉RabbitMQ拒绝这个消息。</p> <p>Channel类中的basicReject方法定义如下：
void basicReject (long deliveryTag,boolean requeue)throws IOException;
其中deliveryTag可以看作消息的编号，它是一个64位的长整型值，最大值是9223372036854775807。如果requeue参数设置为true，则RabbitMQ会重新将这条消息存入队列，以便可以发送给下一个订阅的消费者；如果requeue参数设置为false，则RabbitMQ立即会把消息从队列中移除，而不会把它发送给新的消费者。</p> <p>Basic.Reject命令一次只能拒绝一条消息，如果想要批量拒绝消息，则可以使用
Basic.Nack这个命令。消费者客户端可以调用channel.basicNack方法来实现，方法定义如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">void</span> basicNack <span class="token punctuation">(</span><span class="token keyword">long</span> deliveryTag<span class="token punctuation">,</span><span class="token keyword">boolean</span> multiple<span class="token punctuation">,</span><span class="token keyword">boolean</span> requeue<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中 deliverytag和 requeue的含义可以参考 basicreject方法。 multiple参数设置为 false则表示拒绝编号为 deliverytag的这一条消息，这时候 basicnack和basicreject方法一样； multiple参数设置为tue则表示拒绝 deliverytag编号之前所有未被当前消费者确认的消息。</p> <h4 id="消息恢复"><a href="#消息恢复" class="header-anchor">#</a> 消息恢复</h4> <p>这个 channel. basicrecover方法用来请求 Rabbitmq重新发送还未被确认的消息。如果 requeue参数设置为true，则未被确认的消息会被重新加入到队列中，这样对于同一条消息来说，可能会被分配给与之前不同的消费者。如果 requeue参数设置为 false，那么同一条消息会被分配给与之前相同的消费者。默认情况下，如果不设置 requeue这个参数，相当于channe. basicrecover（true），即 requeue默认为tue</p> <h3 id="关闭连接"><a href="#关闭连接" class="header-anchor">#</a> 关闭连接</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code>channel<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//conn关闭channel也会关闭</span>
conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>连接和信道状态</p> <ul><li>Open：开启状态，代表当前对象可以使用。</li> <li>Closing：正在关闭状态。当前对象被显式地通知调用关闭方法（ shutdown），这样就产生了一个关闭请求让其内部对象进行相应的操作，并等待这些关闭操作的完成。</li> <li>Closed：已经关闭状态。当前对象已经接收到所有的内部对象已完成关闭动作的通知，并且其也关闭了自身。</li></ul> <p>同时还有对应的其他方法</p> <h2 id="消息何去何从"><a href="#消息何去何从" class="header-anchor">#</a> 消息何去何从</h2> <h3 id="mandatory-immediate"><a href="#mandatory-immediate" class="header-anchor">#</a> mandatory&amp;immediate</h3> <p>mandatory和 immediate是 <code>channel.basicpublish</code>方法中的两个参数，它们都有当消息传递过程中不可达目的地时将消息返回给生产者的功能。</p> <p>概括来说：</p> <ul><li>mandatory参数告诉服务器至少将该消息路由到一个队列中，否则将消息返回给生产者。</li> <li>immediate参数告诉服务器，如果该消息关联的队列上有消费者，则立刻投递如果所有匹配的队列上都没有消费者，则直接将消息返还给生产者，不用将消息存入队列而等待消费者了。</li></ul> <p>Rabbitmq提供的备份交换器（ Alternate Exchange）可以将未能被交换器路由的消息（没有绑定队列或者没有匹配的绑定）存储起来，而不用返回给客户端</p> <h3 id="mandatory"><a href="#mandatory" class="header-anchor">#</a> mandatory</h3> <ul><li>true：交换器无法根据自身类型和路由键找到符合的队列，那么 Rabbitmq会调用 Basic.Return命令将消息返回给生产者</li> <li>false：当 mandatory参数设置为 false时，出现上述情形，则消息直接被丢弃。</li></ul> <p>拿回返回来的消息可以用<code>channel.addReturnListener</code>添加<code>ReturnListener</code>监听器来实现</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mandatory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">RabbitMqUtils</span><span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//- true：交换器无法根据自身类型和路由键找到符合的队列，那么 Rabbitmq会调用 Basic.Return命令将消息返回给生产者</span>
  <span class="token comment">//- false：当 mandatory参数设置为 false时，出现上述情形，则消息直接被丢弃。</span>
  channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span>EXCHANGE_NAME<span class="token punctuation">,</span> <span class="token string">&quot;54343&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span>PERSISTENT_TEXT_PLAIN<span class="token punctuation">,</span> <span class="token string">&quot;mandatory_msg&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">addReturnListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span>replyCode<span class="token punctuation">,</span> replyText<span class="token punctuation">,</span> exchange<span class="token punctuation">,</span> routingKey<span class="token punctuation">,</span> properties<span class="token punctuation">,</span> body<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> message <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Basic.Return返回的结果是 ：&quot;</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/mandatory%E5%8F%82%E6%95%B0.png" alt="image-20220103131152641"></p> <h3 id="immediate"><a href="#immediate" class="header-anchor">#</a> immediate</h3> <p>已不支持，影响镜像队列性能，建议采用TTL和DLX方法替代</p> <h3 id="备份交换机"><a href="#备份交换机" class="header-anchor">#</a> 备份交换机</h3> <p>生产者在发送消息的时候如果不设置 mandatory参数，那么消息在未被路由的情况下将会丢失；如果设置了 mandatory参数，那么需要添加 Returnlistener的编程逻辑，生产者的代码将变得复杂。</p> <p>如果既不想复杂化生产者的编程逻辑，又不想消息丢失，那么可以使用备份交换器，这样可以将未被路由的消息存储在 Rabbitmq中，再在需要的时候去处理这些消息。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">alternateExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">RabbitMqUtils</span><span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> args <span class="token operator">=</span> <span class="token class-name">Maps</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;alternate-exchange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;alternate_exchange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;normal_exchange&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BuiltinExchangeType</span><span class="token punctuation">.</span>DIRECT<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;alternate_exchange&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BuiltinExchangeType</span><span class="token punctuation">.</span>FANOUT<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;normal_queue&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span><span class="token string">&quot;normal_queue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;normal_exchange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;normal_key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;unRoute_queue&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span><span class="token string">&quot;unRoute_queue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;alternate_exchange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>声明了两个交换机normal和alternate，分别绑定队列normal和unroute，同时将alternate设置为normal的备份交换机。如果发送消息到Normal上未路由到正确队列，则会发送给备用交换机的队列。为了方便使用备份交换机设置为<code>fanout</code>类型</p> <blockquote><p>消息被重新您发送到备份时的<code>路由键</code>和从生产者发出的路由键一样，如果设置备份交换机为direct且没有路由到队列消息也会丢失</p></blockquote> <p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E5%A4%87%E4%BB%BD%E4%BA%A4%E6%8D%A2%E6%9C%BA.png" alt="image-20220103141226407"></p> <p>可能的情况</p> <ul><li><p>如果设置的备份交换器不存在，客户端和 Rabbitmq服务端都不会有异常出现，此时消息会丢失。</p></li> <li><p>如果备份交换器没有绑定任何队列，客户端和 Rabbitmq服务端都不会有异常出现，此时消息会丢失。</p></li> <li><p>如果备份交换器没有任何匹配的队列，客户端和 Rabbitmq服务端都不会有异常出现，此时消息会丢失。</p></li> <li><p>如果备份交换器和<code>mandatory</code>参数一起使用，那么mandatory参数<code>无效</code>。</p></li></ul> <h2 id="过期时间-ttl"><a href="#过期时间-ttl" class="header-anchor">#</a> 过期时间(TTL)</h2> <p>RabbitMQ可以对消息和队列设置TTL。</p> <ul><li>消息的过期：指限定时间内没有被消费</li> <li>队列的过期：指删除前除于未使用状态的时间</li></ul> <h3 id="设置消息ttl"><a href="#设置消息ttl" class="header-anchor">#</a> 设置消息TTL</h3> <p>目前有两种方法可以设置消息的TTL。</p> <ul><li>第一种方法是通过队列属性设置，队列中所有消息都有相同的过期时间。</li> <li>第二种方法是对消息本身进行单独设置，每条消息的TTL可以不同。</li></ul> <p>如果两种方法一起使用，则消息的TTL以<code>两者之间较小的那个数值为准</code>。消息在队列中的生存时间一旦超过设置的TTL值时，就会变成<code>死信（ Dead Message）</code>，消费者将无法再收到该消息（这点不是绝对的，可以参考4.3节）。</p> <p>设置方法一：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">timeToLive</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">RabbitMqUtils</span><span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> args <span class="token operator">=</span> <span class="token class-name">Maps</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;x-message-ttl&quot;</span><span class="token punctuation">,</span> <span class="token number">6000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//1.声明队列过期</span>
  channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span>QUEUE_NAME<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>还可以通过Policy和HTTP API接口设置。</p> <ul><li>如果不设置TTL，则表示此消息不会过期；</li> <li>如果将TTL设置为0，则表示除非此时可以直接将消息投递到消费者，否则该消息会被立即丢弃，这个特性可以部分替代 Rabbitmq3.0版本之前的 immediate参数，之所以部分代替，是因为 immediate参数在投递失败时会用Basic. Return将消息返回（这个功能可以用死信队列来实现，详细参考4.3节）。</li></ul> <p>设置方法二：</p> <p>针对每条消息设置TTL的方法是在 channel. basicpublish方法中加入 expiration的属性参数，单位为毫秒。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ttl_queue&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> AMQP<span class="token punctuation">.</span><span class="token class-name">BasicProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">deliveryMode</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">expiration</span><span class="token punctuation">(</span><span class="token string">&quot;6000&quot;</span><span class="token punctuation">)</span>
                     <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> MSG<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>判定时机的区别：</p> <ul><li>对于第一种设置队列TL属性的方法，一旦消息过期，就会从队列中抹去</li> <li>而在第二种方法中，即使消息过期，也不会马上从队列中抹去，因为考虑到可能各个消息TTL不同需要扫描整个队列，所以在即将投递到消费者之前判定是否过期然后抹掉</li></ul> <p>区别原因：</p> <ul><li>因为第一种方法里，队列中己过期的消息肯定在队列头部， Rabbitmq只要定期从队头开始扫描是否有过期的消息即可。</li> <li>而第二种方法里，每条消息的过期时间不同，如果要删除所有过期消息势必要扫描整个队列，所以不如等到此消息即将被消费时再判定是否过期，如果过期再进行删除即可即懒加载</li></ul> <h3 id="设置队列ttl"><a href="#设置队列ttl" class="header-anchor">#</a> 设置队列TTL</h3> <p>通过声明队列时的参数<code>x-expires</code>参数可以控制队列被自动删除前处于<code>未使用状态</code>的时间。未使用的意思是：</p> <ul><li>队列上没有任何的消费者</li> <li>队列也没有被重新声明</li> <li>在过期时间段内也未调用过 Basic.Get命令</li></ul> <p>设置队列里的TTL可以应用于类似RPC方式的回复队列，在RPC中，许多队列会被创建
出来，但是却是未被使用的。</p> <p>Rabbitmq会确保在过期时间到达后将队列删除，但是不保障删除的动作有多及时。在
Rabbitmq重启后，持久化的队列的过期时间会被重新计算。</p> <p>用于表示过期时间的x- expires参数以毫秒为单位，并且服从和x- message-tt1一样的约束条件，不过不能设置为0。比如该参数设置为1000，则表示该队列如果在1秒钟之内未使用则会被删除</p> <h2 id="死信队列"><a href="#死信队列" class="header-anchor">#</a> 死信队列</h2> <p>DLX，全称为 Dead-letter-Exchange，可以称之为死信交换器，也有人称之为死信邮箱。当消息在一个队列中变成死信（ dead message）之后，它能被重新被发送到另一个交换器中，这个交换器就是DLX，绑定DLX的队列就称之为死信队列。</p> <h3 id="消息成为死信的情况"><a href="#消息成为死信的情况" class="header-anchor">#</a> 消息成为死信的情况</h3> <ul><li>消息被拒绝（ Basic.Reject/ Basic.Nack）并且设置 requeue参数为 false</li> <li>消息过期</li> <li>队列达到最大长度。</li></ul> <p>DLX也是一个正常的交换器，和一般的交换器没有区别，它能在任何的队列上被指定，实
际上就是设置某个队列的属性。当这个队列中存在死信时， Rabbitmq就会自动地将这个消息重新发布到设置的DLX上去，进而被路由到另一个队列，即死信队列。</p> <p>可以监听这个队列中的消息以进行相应的处理，这个特性与将消息的TTL设置为0配合使用可以弥补 <code>immediate</code>参数的功能。</p> <p>通过在 <code>channe.queuedeclare</code>方法中设置<code>x-dead-letter-exchange</code>参数来为这个队列添加DLX（代码清单4-7中的d1_exchange）</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">dlx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">RabbitMqUtils</span><span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//声明死信交换器</span>
  channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;dlx_exchange&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BuiltinExchangeType</span><span class="token punctuation">.</span>DIRECT<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> args <span class="token operator">=</span> <span class="token class-name">Maps</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;x-dead-letter-exchange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dlx_exchange&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//死信交换器的路由，不指定则用生产者发送消息是的路由</span>
  args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;x-dead-letter-routing-key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;dlx_routing_key&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//给队列添加DLX</span>
  channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;dlx_queue&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h3> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
     * @description: ttl和dlx示例,消息过期后会被发送到死信交换器绑定的死信队列
     **/</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ttlAndDlx</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
  <span class="token class-name">Channel</span> channel <span class="token operator">=</span> <span class="token class-name">RabbitMqUtils</span><span class="token punctuation">.</span><span class="token function">getChannel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//声明死信交换器</span>
  channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;exchange.dlx&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BuiltinExchangeType</span><span class="token punctuation">.</span>DIRECT<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//声明普通交换机</span>
  channel<span class="token punctuation">.</span><span class="token function">exchangeDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;exchange.normal&quot;</span><span class="token punctuation">,</span> <span class="token class-name">BuiltinExchangeType</span><span class="token punctuation">.</span>FANOUT<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> args <span class="token operator">=</span> <span class="token class-name">Maps</span><span class="token punctuation">.</span><span class="token function">newHashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;x-message-ttl&quot;</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;x-dead-letter-exchange&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exchange.dlx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  args<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;x-dead-letter-routing-key&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;routingKey&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;queue.normal&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span><span class="token string">&quot;queue.normal&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exchange.normal&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueDeclare</span><span class="token punctuation">(</span><span class="token string">&quot;queue.dlx&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">queueBind</span><span class="token punctuation">(</span><span class="token string">&quot;queue.dlx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;exchange.dlx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;routingKey&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  channel<span class="token punctuation">.</span><span class="token function">basicPublish</span><span class="token punctuation">(</span><span class="token string">&quot;exchange.normal&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token class-name">MessageProperties</span><span class="token punctuation">.</span>PERSISTENT_TEXT_PLAIN<span class="token punctuation">,</span> <span class="token string">&quot;dlx_1&quot;</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><img src="https://blog-1300186248.cos.ap-shanghai.myqcloud.com/RabbitMQ/%E6%AD%BB%E4%BF%A1%E9%98%9F%E5%88%97.png" alt="image-20220103211442199"></p> <p>对于 Rabbitmq来说，DLX是一个非常有用的特性。它可以处理异常情况下，消息不能够被消费者正确消费（消费者调用了 Basic.Nack或者 Basic. Reject）而被置入死信队列中的情况，后续分析程序可以通过消费这个死信队列中的内容来分析当时所遇到的异常情况，进而可以改善和优化系统。DLX配合TTL使用还可以实现延迟队列的功能，详细请看下一节。</p> <h2 id="延迟队列"><a href="#延迟队列" class="header-anchor">#</a> 延迟队列</h2></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/LifeAlsoIsGG/edit/master/MQ/RabbitMQ/RabbitMQ.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次编辑于:</span> <span class="time">2022年1月5日 06:52</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/Nginx/Nginx-Dynamic&amp;static/" class="prev"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon prev-icon"><path d="M906.783 588.79c-.02 8.499-6.882 15.36-15.38 15.37l-443.7-.01 75.704 191.682c2.52 6.42.482 13.763-5.038 17.91-5.52 4.168-13.138 4.147-18.616-.092L123.228 524.175a15.362 15.362 0 01-6-12.165c0-4.782 2.222-9.277 6-12.185L499.753 210.35a15.388 15.388 0 019.38-3.195c3.236 0 6.502 1.034 9.236 3.103 5.52 4.147 7.578 11.49 5.038 17.91L447.683 419.84l443.72-.01c8.498.01 15.36 6.881 15.36 15.36l.02 153.6z" fill="currentColor"></path></svg>
        Nginx-动静分离
      </a></span> <span class="next"><a href="/MQ/RabbitMQ/RabbitMQ-Interview">
        /MQ/RabbitMQ/RabbitMQ-Interview
        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon next-icon"><path d="M906.772 512c0 4.772-2.211 9.267-5.99 12.175L524.257 813.66a15.37 15.37 0 01-18.616.092 15.368 15.368 0 01-5.038-17.91l75.714-191.672h-443.73c-8.488 0-15.36-6.881-15.36-15.36v-153.6c0-8.489 6.872-15.36 15.36-15.36h443.73l-75.714-191.682a15.358 15.358 0 015.048-17.91c5.51-4.158 13.128-4.137 18.606.092l376.525 289.485a15.323 15.323 0 015.99 12.165z" fill="currentColor"></path></svg></a></span></p></div> <div class="comments-wrapper"><div class="valine-wrapper"><div id="valine"></div></div></div> </main> <footer class="footer-wrapper"><div class="media-links-wrapper"><a href="https://github.com/LifeAlsoIsGG" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><path d="M544.06 959.267h-64.95c-228.633 0-415.697-187.064-415.697-415.698V478.62c0-228.633 187.064-415.697 415.698-415.697h64.949c228.633 0 415.697 187.064 415.697 415.697v64.95c0 228.633-187.065 415.697-415.697 415.697z" fill="#171515"></path> <path d="M510.25 263.81c-136.001 0-246.287 110.273-246.287 246.317 0 108.81 70.566 201.128 168.45 233.701 12.315 2.259 16.81-5.345 16.81-11.872 0-5.847-.212-21.337-.332-41.891-68.514 14.884-82.97-33.017-82.97-33.017-11.199-28.454-27.347-36.029-27.347-36.029-22.362-15.282 1.692-14.972 1.692-14.972 24.717 1.742 37.727 25.382 37.727 25.382 21.971 37.64 57.646 26.77 71.681 20.465 2.238-15.917 8.6-26.77 15.638-32.927-54.693-6.216-112.191-27.347-112.191-121.73 0-26.889 9.597-48.876 25.352-66.093-2.533-6.232-10.985-31.274 2.414-65.184 0 0 20.68-6.622 67.731 25.25 19.647-5.464 40.716-8.196 61.663-8.291 20.916.095 41.987 2.828 61.662 8.29 47.023-31.872 67.665-25.249 67.665-25.249 13.437 33.91 4.983 58.952 2.451 65.184 15.785 17.217 25.318 39.203 25.318 66.093 0 94.62-57.588 115.44-112.458 121.538 8.845 7.604 16.721 22.637 16.721 45.612 0 32.927-.302 59.493-.302 67.568 0 6.587 4.437 14.25 16.936 11.843 97.788-32.634 168.295-124.89 168.295-233.672 0-136.043-110.287-246.316-246.319-246.316z" fill="#FFF"></path></svg></a><a href="https://twitter.com/LifeAlsoIsGG" rel="noopener noreferrer" target="_blank" aria-label="Twitter" data-balloon-pos="up" class="media-link"><span class="sr-only">Twitter</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-twitter"><path d="M544.06 959.267h-64.95c-228.633 0-415.697-187.064-415.697-415.698V478.62c0-228.633 187.064-415.697 415.698-415.697h64.949c228.633 0 415.697 187.064 415.697 415.697v64.95c0 228.633-187.065 415.697-415.697 415.697z" fill="#5EAADE"></path> <path d="M749.737 364.631c-17.594 7.805-36.513 13.088-56.371 15.459 20.269-12.148 35.836-31.387 43.156-54.312A196.233 196.233 0 01674.2 349.6c-17.894-19.083-43.406-30.997-71.636-30.997-54.2 0-98.137 43.944-98.137 98.157 0 7.695.861 15.19 2.544 22.373-81.57-4.092-153.876-43.174-202.284-102.558-8.443 14.498-13.285 31.356-13.285 49.348 0 34.05 17.326 64.096 43.656 81.697a97.69 97.69 0 01-44.447-12.277c-.01.41-.01.82-.01 1.24 0 47.558 33.822 87.23 78.72 96.249a98.285 98.285 0 01-25.852 3.448 97.491 97.491 0 01-18.465-1.768c12.483 39.002 48.725 67.38 91.672 68.17-33.582 26.334-75.897 42.024-121.884 42.024-7.924 0-15.736-.46-23.408-1.37 43.434 27.844 95.014 44.104 150.443 44.104 180.505 0 279.221-149.576 279.221-279.294 0-4.263-.09-8.494-.278-12.708 19.178-13.835 35.813-31.115 48.967-50.807z" fill="#FFF"></path></svg></a><a href="http://localhost:8083/blog-vuepress/tencent:/AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1138312802.html" rel="noopener noreferrer" target="_blank" aria-label="QQ" data-balloon-pos="up" class="media-link"><span class="sr-only">QQ</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-qq"><path d="M544.06 959.267h-64.95c-228.633 0-415.697-187.064-415.697-415.698V478.62c0-228.633 187.064-415.697 415.698-415.697h64.949c228.633 0 415.697 187.064 415.697 415.697v64.95c0 228.633-187.065 415.697-415.697 415.697z" fill="#5EAADE"></path> <path d="M729.46 627.3c-3.157-39.628-24.045-83.747-32.624-105.91l-22.084-57.047c-.702-23.73 6.312-78.322-30.511-146.61s-110.82-74.446-124.497-75.147c-13.677-.701-99.248-1.403-141.331 72.945-42.084 74.347-30.745 148.812-30.745 148.812l-23.523 57.478c-.001.002-10.962 26.223-20.43 58.135-9.469 31.914-18.938 82.064-9.469 92.234 9.47 10.17 43.837-46.643 46.993-51.903 0 0 2.456 27.18 8.943 41.383l.81 1.776.33.723.38.826.3.652.444.96.203.436a281.465 281.465 0 001.917 4.025l.189.386c.231.473.468.953.711 1.442l.146.292c6.886 13.807 18.61 33.823 37.443 50.42l.018.016-1.184.387c-10.667 3.516-31.694 11.21-40.625 19.82-1.717 1.655-2.987 3.344-3.65 5.045-5.376 13.794 4.208 15.43 20.575 16.366 16.366.934 94.923 3.04 132.564-2.221.407-.056.787-.114 1.17-.171 2.711.094 5.324.142 7.83.16l.151.002c.836.005 1.663.008 2.475.008.496 0 1.015-.002 1.542-.006l.21-.001a222.593 222.593 0 005.462-.107c.26.038.508.076.778.114 37.642 5.26 116.198 3.156 132.564 2.22 16.366-.934 25.951-2.571 20.574-16.365-4.302-11.037-34.175-21.62-45.956-25.413a141.388 141.388 0 007.958-7.645l.237-.245a142.494 142.494 0 002.53-2.702c42.435-46.643 38.928-76.101 40.682-92.935 0 0 35.775 51.553 43.488 53.306 7.713 1.754 10.169-6.31 7.012-45.94z" fill="#FFF"></path></svg></a></div> <div class="footer">粤ICP备19126168号</div> <div class="copyright">Copyright © 2020 Draco</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">该应用可以安装在您的 PC 或移动设备上。这将使该 Web 应用程序外观和行为与其他应用程序相同。它将在出现在应用程序列表中，并可以固定到主屏幕，开始菜单或任务栏。此 Web 应用程序还将能够与其他应用程序和您的操作系统安全地进行交互。</p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>详情</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        安装 <span></span></button> <button class="cancel-button">
        取消
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="Close (Esc)" class="pswp__button pswp__button--close"></button> <button title="Share" class="pswp__button pswp__button--share"></button> <button title="Toggle fullscreen" class="pswp__button pswp__button--fs"></button> <button title="Zoom in/out" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="Previous (arrow left)" class="pswp__button pswp__button--arrow--left"></button> <button title="Next (arrow right)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/assets/js/app.8e6f7e47.js" defer></script><script src="/assets/js/layout-Layout.01663f32.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.29afc31d.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound~layout-Slide.b32f4377.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout.02c7d76a.js" defer></script><script src="/assets/js/page-RabbitMQ--4585be74.ecf9621f.js" defer></script>
  </body>
</html>
